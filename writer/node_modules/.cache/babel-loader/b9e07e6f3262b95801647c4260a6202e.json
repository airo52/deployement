{"ast":null,"code":"import _toConsumableArray from\"/Users/tony/Documents/Projects/react/Writer/writer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/tony/Documents/Projects/react/Writer/writer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{CBadge,CDropdown,CDropdownItem,CDropdownMenu,CDropdownToggle,CImg}from'@coreui/react';import CIcon from'@coreui/icons-react';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import ChatBox from'src/views/ChatBox/ChatBox';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var TheHeaderDropdownMssg=function TheHeaderDropdownMssg(_ref){var socket=_ref.socket,state=_ref.state;var notify=function notify(data){return toast(data);};var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),taskid=_useState6[0],setTaskid=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),newMessage=_useState8[0],setNewMessage=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),itemsCount=_useState10[0],setItemCount=_useState10[1];var Open=function Open(mail,taskid){setTaskid(taskid);setEmail(mail);setOpen(!open);var lists=newMessage.filter(function(x){return x.task_id!=taskid;});// console.log(lists)\nsetNewMessage(lists);setTimeout(function(){// Count()\nvar legth=lists.length;setItemCount(legth);},1200);};var notifY=function notifY(){if(state){socket.on('newMessage',function(message){//console.log(message);\nnotify('you have a new message from '+message.username+\"...\"+message.message.substring(0,100));// setNewMessage([...newMessage,message]);\n//alert(test)\n});}};useEffect(function(){notifY();},[]);useEffect(function(){notifY();},[]);var Count=function Count(){var legth=newMessage.length;setItemCount(legth+1);};if(state){socket.on('newMessage',function(message){//console.log(message);\n//clearTimeout(Alert);\n//Alert(message)\nvar found=newMessage.some(function(item){return item.task_id===message.task_id;});if(found==false){/*  this.setState({people: this.state.people.filter(function(person) { \n            return person !== e.target.value \n        })});*/var Newt=newMessage.filter(function(item){return item.task_id!==message.task_id;});setNewMessage([].concat(_toConsumableArray(Newt),[message]));}setTimeout(function(){Count();},1200);},[]);}/*\n   if(state){\n    socket.on('newMessage',(message)=>{\n     console.log(message);\n        notify('you have a new message from '+message.username+\"...\"+message.message.substring(0, 100));\n      //alert(test)\n    })\n   }*/ //const itemsCount = 4\nreturn/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(CDropdown,{inNav:true,className:\"c-header-nav-item mx-2\",direction:\"down\",children:[/*#__PURE__*/_jsxs(CDropdownToggle,{className:\"c-header-nav-link\",caret:false,children:[/*#__PURE__*/_jsx(CIcon,{name:\"cil-envelope-open\"}),/*#__PURE__*/_jsx(CBadge,{shape:\"pill\",color:\"info\",children:itemsCount})]}),/*#__PURE__*/_jsxs(CDropdownMenu,{className:\"pt-0\",placement:\"bottom-end\",children:[/*#__PURE__*/_jsx(CDropdownItem,{header:true,tag:\"div\",color:\"light\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"You have \",itemsCount,\" messages\"]})}),newMessage.map(function(item){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(CDropdownItem,{onClick:function onClick(){return Open(item.sender_id,item.task_id);},href:\"#\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"message\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pt-3 mr-3 float-left\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"c-avatar\",children:[/*#__PURE__*/_jsx(CImg,{style:{width:\"40px\",height:\"40px\",borderRadius:\"20px\"},src:item.Imageurl,className:\"c-avatar-img\",alt:\"admin@bootstrapmaster.com\"}),/*#__PURE__*/_jsx(\"span\",{className:\"c-avatar-status bg-warning\"})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:item.username}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted float-right mt-1\",children:\"5 minutes ago\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-truncate font-weight-bold\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"small text-muted text-truncate\",children:/*#__PURE__*/_jsx(\"p\",{children:item.message})}),/*#__PURE__*/_jsx(\"br\",{})]})})});})]})]}),open&&/*#__PURE__*/_jsx(ChatBox,{open:open,SetOpen:Open,email:email,socket:socket,taskid:taskid})]});};export default TheHeaderDropdownMssg;","map":{"version":3,"sources":["/Users/tony/Documents/Projects/react/Writer/writer/src/containers/TheHeaderDropdownMssg.js"],"names":["React","useEffect","useState","CBadge","CDropdown","CDropdownItem","CDropdownMenu","CDropdownToggle","CImg","CIcon","ToastContainer","toast","ChatBox","TheHeaderDropdownMssg","socket","state","notify","data","open","setOpen","email","setEmail","taskid","setTaskid","newMessage","setNewMessage","itemsCount","setItemCount","Open","mail","lists","filter","x","task_id","setTimeout","legth","length","notifY","on","message","username","substring","Count","found","some","item","Newt","map","sender_id","width","height","borderRadius","Imageurl"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport {\n  CBadge,\n  CDropdown,\n  CDropdownItem,\n  CDropdownMenu,\n  CDropdownToggle,\n  CImg\n} from '@coreui/react'\nimport CIcon from '@coreui/icons-react';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport ChatBox from 'src/views/ChatBox/ChatBox';\n\nconst TheHeaderDropdownMssg = ({socket,state}) => {\n  const notify = (data) => toast(data);\n  \n\n  const [open,setOpen]=useState(false);\n  const [email,setEmail] = useState('');\n  const [taskid,setTaskid] =useState('');\n  const [newMessage,setNewMessage] = useState([]);\n  const [itemsCount,setItemCount] = useState(0);\n  const Open=(mail,taskid)=>{\n    setTaskid(taskid);\n    setEmail(mail);\n    setOpen(!open);\n\n    var lists = newMessage.filter(x => {\n      return x.task_id != taskid;\n    })\n\n   // console.log(lists)\n    setNewMessage(lists);\n\n    setTimeout(() => {\n     // Count()\n     var legth = lists.length;\n\n     setItemCount(legth);\n   }, 1200);\n   }\n\n\n   const notifY=()=>{\n    if(state){\n     \n      socket.on('newMessage',(message)=>{\n        //console.log(message);\n          notify('you have a new message from '+message.username+\"...\"+message.message.substring(0, 100));\n  \n         // setNewMessage([...newMessage,message]);\n        //alert(test)\n      })\n     }\n   }\n\n   useEffect(()=>{\n    notifY();\n   },[]);\n\n\n   useEffect(()=>{\n     notifY();\n   },[]);\n   const Count = ()=>{\n    var legth = newMessage.length;\n\n  setItemCount(legth +1);\n}\n\nif(state){\n  socket.on('newMessage',(message)=>{\n    //console.log(message);\n        //clearTimeout(Alert);\n        //Alert(message)\n\n        const found = newMessage.some(item=>item.task_id === message.task_id);\n        \n        if(found == false){\n        /*  this.setState({people: this.state.people.filter(function(person) { \n            return person !== e.target.value \n        })});*/\n        var Newt = newMessage.filter(function(item) { \n          return item.task_id !== message.task_id \n      })\n          setNewMessage([...Newt,message]);\n        }\n        setTimeout(() => {\n           Count()\n        }, 1200);\n\n       \n    \n  },[]);\n }\n/*\n   if(state){\n    socket.on('newMessage',(message)=>{\n     console.log(message);\n        notify('you have a new message from '+message.username+\"...\"+message.message.substring(0, 100));\n      //alert(test)\n    })\n   }*/\n  //const itemsCount = 4\n  return (\n    <>\n    <CDropdown\n      inNav\n      className=\"c-header-nav-item mx-2\"\n      direction=\"down\"\n    >\n      <CDropdownToggle className=\"c-header-nav-link\" caret={false}>\n        <CIcon name=\"cil-envelope-open\" /><CBadge shape=\"pill\" color=\"info\">{itemsCount}</CBadge>\n      </CDropdownToggle>\n      <CDropdownMenu className=\"pt-0\" placement=\"bottom-end\">\n        <CDropdownItem\n          header\n          tag=\"div\"\n          color=\"light\"\n        >\n          <strong>You have {itemsCount} messages</strong>\n        </CDropdownItem>\n      \n        {newMessage.map((item)=>{\n         return <>\n                   <CDropdownItem onClick={()=>Open(item.sender_id,item.task_id)} href=\"#\">\n          <div className=\"message\">\n            <div className=\"pt-3 mr-3 float-left\">\n              <div className=\"c-avatar\">\n                <CImg\n                 style={{width:\"40px\",height:\"40px\",borderRadius:\"20px\"}}\n                  src={item.Imageurl}\n                  className=\"c-avatar-img\"\n                  alt=\"admin@bootstrapmaster.com\"\n                />\n                <span className=\"c-avatar-status bg-warning\"></span>\n              </div>\n            </div>\n            <div>\n              <small className=\"text-muted\">{item.username}</small>\n              <small className=\"text-muted float-right mt-1\">5 minutes ago</small>\n            </div>\n            <div className=\"text-truncate font-weight-bold\"></div>\n            <br/>\n            <div className=\"small text-muted text-truncate\">\n              <p>{item.message}</p>\n            </div>\n            <br/>\n          </div>\n        </CDropdownItem>\n                </>\n       })}\n       \n      </CDropdownMenu>\n    </CDropdown>\n    {open && <ChatBox\n    open={open}\n    SetOpen={Open}\n    email={email}\n    socket={socket}\n    taskid={taskid}\n   />}\n    </>\n  )\n}\n\nexport default TheHeaderDropdownMssg"]},"metadata":{},"sourceType":"module"}